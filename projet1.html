<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.358/pdf.min.js"></script>
<script>
const url = 'images/projet1/PowerBiImmo.pdf'; // sans "/" initial
let pdfDoc = null, pageNum = 1;
const canvas = document.getElementById('pdf-render');
const ctx = canvas.getContext('2d');
const caption = document.getElementById('caption-text');

// PDF.js worker
pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.358/pdf.worker.min.js';

// Chargement du PDF
pdfjsLib.getDocument(url).promise.then(doc => {
  pdfDoc = doc;
  renderPage(pageNum);
}).catch(err => {
  console.error('Erreur PDF:', err);
});

// Fonction pour afficher une page
function renderPage(num) {
  pdfDoc.getPage(num).then(page => {
    const scale = 1.2; // Ajustable selon taille canvas
    const viewport = page.getViewport({ scale });

    canvas.width = viewport.width;
    canvas.height = viewport.height;

    page.render({ canvasContext: ctx, viewport: viewport }).promise.then(() => {
      caption.textContent = `Page ${pageNum} / ${pdfDoc.numPages}`;
    });
  });
}

// Navigation
document.querySelector('.prev').addEventListener('click', () => {
  if (pageNum <= 1) return;
  pageNum--;
  renderPage(pageNum);
});
document.querySelector('.next').addEventListener('click', () => {
  if (pageNum >= pdfDoc.numPages) return;
  pageNum++;
  renderPage(pageNum);
});
</script>
