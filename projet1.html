const url = '/images/projet1/PowerBiImmo.pdf';
let pdfDoc = null, pageNum = 1;
const canvas = document.getElementById('pdf-render');
const ctx = canvas.getContext('2d');
const caption = document.getElementById('caption-text');

pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.358/pdf.worker.min.js';

pdfjsLib.getDocument(url).promise.then(doc => {
  pdfDoc = doc;
  renderPage(pageNum);
}).catch(err => {
  console.error('Erreur lors du chargement du PDF :', err);
});

function renderPage(num) {
  pdfDoc.getPage(num).then(page => {
    const scale = 1.5; // ajuster pour la lisibilitÃ©
    const viewport = page.getViewport({ scale });

    canvas.width = viewport.width;
    canvas.height = viewport.height;

    const renderContext = {
      canvasContext: ctx,
      viewport: viewport
    };
    page.render(renderContext).promise.then(() => {
      caption.textContent = `Page ${pageNum} / ${pdfDoc.numPages}`;
    });
  });
}

document.querySelector('.prev').addEventListener('click', () => {
  if (pageNum <= 1) return;
  pageNum--;
  renderPage(pageNum);
});

document.querySelector('.next').addEventListener('click', () => {
  if (pageNum >= pdfDoc.numPages) return;
  pageNum++;
  renderPage(pageNum);
});
